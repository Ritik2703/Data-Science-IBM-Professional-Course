{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655289357_1413398590","id":"20200516-185449_935962899","dateCreated":"2020-05-16T18:54:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:215","text":"%sh\nwget  --quiet --output-document bank.csv  https://s3.amazonaws.com/apache-zeppelin/tutorial/bank/bank.csv ","dateUpdated":"2020-05-16T18:55:44+0000","dateFinished":"2020-05-16T18:55:46+0000","dateStarted":"2020-05-16T18:55:44+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nfrom pyspark.sql.types import *\n","user":"anonymous","dateUpdated":"2020-05-16T18:56:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655344200_109941284","id":"20200516-185544_862340464","dateCreated":"2020-05-16T18:55:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:359","dateFinished":"2020-05-16T18:56:23+0000","dateStarted":"2020-05-16T18:56:06+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nbankDataset = sc.textFile(\"bank.csv\")\nprint bankDataset.take(5)","user":"anonymous","dateUpdated":"2020-05-16T18:56:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655366376_1738578914","id":"20200516-185606_1176314734","dateCreated":"2020-05-16T18:56:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:444","dateFinished":"2020-05-16T18:56:43+0000","dateStarted":"2020-05-16T18:56:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[u'\"age\";\"job\";\"marital\";\"education\";\"default\";\"balance\";\"housing\";\"loan\";\"contact\";\"day\";\"month\";\"duration\";\"campaign\";\"pdays\";\"previous\";\"poutcome\";\"y\"', u'30;\"unemployed\";\"married\";\"primary\";\"no\";1787;\"no\";\"no\";\"cellular\";19;\"oct\";79;1;-1;0;\"unknown\";\"no\"', u'33;\"services\";\"married\";\"secondary\";\"no\";4789;\"yes\";\"yes\";\"cellular\";11;\"may\";220;1;339;4;\"failure\";\"no\"', u'35;\"management\";\"single\";\"tertiary\";\"no\";1350;\"yes\";\"no\";\"cellular\";16;\"apr\";185;1;330;1;\"failure\";\"no\"', u'30;\"management\";\"married\";\"tertiary\";\"no\";1476;\"yes\";\"yes\";\"unknown\";3;\"jun\";199;4;-1;0;\"unknown\";\"no\"']\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.167.54:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nbankRDD = bankDataset.map(lambda s: s.split(\";\")).filter(lambda s: s[0] != \"\\\"age\\\"\").map(lambda s:(int(s[0]), str(s[1]).replace(\"\\\"\", \"\"), str(s[2]).replace(\"\\\"\", \"\"), str(s[3]).replace(\"\\\"\", \"\"), int(s[5]) ))\nprint bankRDD.take(5)\n","user":"anonymous","dateUpdated":"2020-05-16T18:57:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655402005_1653739797","id":"20200516-185642_403082191","dateCreated":"2020-05-16T18:56:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:541","dateFinished":"2020-05-16T18:57:17+0000","dateStarted":"2020-05-16T18:57:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(30, 'unemployed', 'married', 'primary', 1787), (33, 'services', 'married', 'secondary', 4789), (35, 'management', 'single', 'tertiary', 1350), (30, 'management', 'married', 'tertiary', 1476), (59, 'blue-collar', 'married', 'secondary', 0)]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.167.54:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nbankSchema = StructType([StructField(\"age\", IntegerType(), False),StructField(\"job\", StringType(), False),StructField(\"marital\", StringType(), False),StructField(\"education\", StringType(), False),StructField(\"balance\", IntegerType(), False)])","user":"anonymous","dateUpdated":"2020-05-16T18:57:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655437256_666916348","id":"20200516-185717_413049683","dateCreated":"2020-05-16T18:57:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:654","dateFinished":"2020-05-16T18:57:35+0000","dateStarted":"2020-05-16T18:57:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%md\nIn this step, we apply _schema_ to _bankRDD_ and create a _DataFrame_ using __Spark SQL__.\nSpark SQL supports operating on a variety of data sources through the DataFrame interface. The entry point into all relational functionality in Spark is the __SQLContext__ class. With a SQLContext, you can create DataFrames from an existing RDD.\nRunning following code, creates a DataFrame, i.e. __bankRDD__, and shows the first 10 rows of DataFrame.\n","user":"anonymous","dateUpdated":"2020-05-16T18:57:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655455719_1861182565","id":"20200516-185735_469566746","dateCreated":"2020-05-16T18:57:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:770","dateFinished":"2020-05-16T18:57:56+0000","dateStarted":"2020-05-16T18:57:53+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>In this step, we apply <em>schema</em> to <em>bankRDD</em> and create a <em>DataFrame</em> using <strong>Spark SQL</strong>.<br/>Spark SQL supports operating on a variety of data sources through the DataFrame interface. The entry point into all relational functionality in Spark is the <strong>SQLContext</strong> class. With a SQLContext, you can create DataFrames from an existing RDD.<br/>Running following code, creates a DataFrame, i.e. <strong>bankRDD</strong>, and shows the first 10 rows of DataFrame.</p>\n</div>"}]}},{"text":"%pyspark\nbankdf = spark.createDataFrame(bankRDD,bankSchema)\nbankdf.show(5)\n","user":"anonymous","dateUpdated":"2020-05-16T18:58:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655473047_-1473303763","id":"20200516-185753_792382777","dateCreated":"2020-05-16T18:57:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:843","dateFinished":"2020-05-16T18:58:17+0000","dateStarted":"2020-05-16T18:58:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----------+-------+---------+-------+\n|age|        job|marital|education|balance|\n+---+-----------+-------+---------+-------+\n| 30| unemployed|married|  primary|   1787|\n| 33|   services|married|secondary|   4789|\n| 35| management| single| tertiary|   1350|\n| 30| management|married| tertiary|   1476|\n| 59|blue-collar|married|secondary|      0|\n+---+-----------+-------+---------+-------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.167.54:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nbankdf.registerTempTable(\"bank\")","user":"anonymous","dateUpdated":"2020-05-16T18:58:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655495498_-481682474","id":"20200516-185815_1280974644","dateCreated":"2020-05-16T18:58:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:941","dateFinished":"2020-05-16T18:58:35+0000","dateStarted":"2020-05-16T18:58:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\nselect * from bank LIMIT 5","user":"anonymous","dateUpdated":"2020-05-16T18:58:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","job":"string","marital":"string","education":"string","balance":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655515412_-1369571637","id":"20200516-185835_170992035","dateCreated":"2020-05-16T18:58:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1054","dateFinished":"2020-05-16T18:58:49+0000","dateStarted":"2020-05-16T18:58:49+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\tjob\tmarital\teducation\tbalance\n30\tunemployed\tmarried\tprimary\t1787\n33\tservices\tmarried\tsecondary\t4789\n35\tmanagement\tsingle\ttertiary\t1350\n30\tmanagement\tmarried\ttertiary\t1476\n59\tblue-collar\tmarried\tsecondary\t0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.167.54:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"text":"%sql\nselect age, education, sum(balance) bal from bank\ngroup by age, education","user":"anonymous","dateUpdated":"2020-05-16T19:01:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","education":"string","bal":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"education","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655529498_-1547586843","id":"20200516-185849_2137865346","dateCreated":"2020-05-16T18:58:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1138","dateFinished":"2020-05-16T19:01:10+0000","dateStarted":"2020-05-16T19:01:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"age\teducation\tbal\n29\tprimary\t1048\n22\tprimary\t3472\n69\ttertiary\t2617\n68\tsecondary\t23506\n29\tsecondary\t63447\n62\ttertiary\t1865\n69\tunknown\t426\n49\tsecondary\t101703\n55\ttertiary\t28689\n71\tsecondary\t2850\n32\tsecondary\t115051\n52\ttertiary\t18538\n67\tprimary\t2301\n65\tunknown\t5317\n43\tunknown\t11397\n33\tprimary\t24768\n57\tunknown\t6726\n71\ttertiary\t15217\n57\tprimary\t33000\n42\tsecondary\t83363\n54\tsecondary\t22068\n65\tprimary\t4512\n26\tprimary\t7726\n56\tunknown\t5632\n31\tunknown\t635\n43\tsecondary\t82498\n34\tsecondary\t112504\n55\tunknown\t4056\n47\tsecondary\t78778\n44\tunknown\t1174\n45\tprimary\t44588\n86\tsecondary\t1503\n31\tsecondary\t104499\n42\tprimary\t40882\n28\tprimary\t1961\n24\tunknown\t3729\n58\tprimary\t48625\n35\tprimary\t13227\n47\ttertiary\t49685\n50\tprimary\t42974\n73\tprimary\t2617\n40\tunknown\t9716\n42\ttertiary\t93304\n50\ttertiary\t43378\n21\tsecondary\t12283\n25\ttertiary\t27302\n64\tprimary\t811\n67\tsecondary\t16353\n23\tsecondary\t21128\n56\tprimary\t16366\n55\tprimary\t40416\n28\tsecondary\t64651\n52\tsecondary\t36593\n54\tprimary\t18305\n41\tsecondary\t91940\n40\tsecondary\t98662\n33\tunknown\t24316\n23\ttertiary\t1998\n60\tunknown\t15024\n77\tprimary\t1360\n59\tunknown\t8646\n53\tsecondary\t62148\n27\tsecondary\t48959\n38\tunknown\t3638\n22\tsecondary\t7178\n26\tsecondary\t34353\n60\tsecondary\t19437\n79\tprimary\t8985\n29\ttertiary\t54314\n51\ttertiary\t31479\n69\tprimary\t858\n53\ttertiary\t45412\n28\tunknown\t1390\n40\ttertiary\t75443\n32\ttertiary\t141981\n49\ttertiary\t27788\n32\tunknown\t21538\n53\tprimary\t37193\n19\tunknown\t1169\n44\ttertiary\t72648\n58\tsecondary\t45864\n53\tunknown\t4548\n38\tprimary\t17406\n27\ttertiary\t25774\n45\tunknown\t12395\n59\tsecondary\t46515\n48\ttertiary\t56018\n83\tsecondary\t0\n36\tsecondary\t86138\n64\ttertiary\t2415\n50\tunknown\t9220\n36\tunknown\t3541\n37\ttertiary\t84184\n46\tunknown\t9570\n33\ttertiary\t105706\n54\ttertiary\t63140\n40\tprimary\t14909\n66\ttertiary\t13910\n87\tprimary\t230\n50\tsecondary\t70579\n78\ttertiary\t226\n36\ttertiary\t130534\n66\tprimary\t953\n25\tsecondary\t17283\n70\tprimary\t8313\n44\tprimary\t17564\n47\tunknown\t7383\n71\tprimary\t4657\n73\tunknown\t519\n22\tunknown\t596\n77\tsecondary\t610\n57\tsecondary\t72359\n35\tsecondary\t103576\n27\tunknown\t3255\n84\tprimary\t639\n75\ttertiary\t3810\n72\tsecondary\t4130\n45\ttertiary\t27906\n73\tsecondary\t19\n60\tprimary\t90637\n19\tsecondary\t302\n49\tprimary\t45604\n72\tprimary\t5974\n30\ttertiary\t103494\n26\ttertiary\t18640\n24\tsecondary\t11219\n25\tunknown\t10788\n22\ttertiary\t1852\n44\tsecondary\t101452\n76\tprimary\t2676\n39\tprimary\t25197\n27\tprimary\t2079\n51\tunknown\t42195\n64\tunknown\t2923\n31\ttertiary\t119916\n34\ttertiary\t132905\n77\ttertiary\t12461\n63\tprimary\t9128\n79\tsecondary\t4738\n56\ttertiary\t66399\n48\tprimary\t38132\n35\ttertiary\t97035\n41\tunknown\t7318\n78\tsecondary\t499\n60\ttertiary\t14237\n69\tsecondary\t745\n58\ttertiary\t47836\n30\tsecondary\t57899\n52\tprimary\t7776\n75\tprimary\t852\n58\tunknown\t6857\n21\tunknown\t137\n33\tsecondary\t132657\n61\ttertiary\t13623\n55\tsecondary\t38884\n70\ttertiary\t15834\n31\tprimary\t31358\n34\tprimary\t6941\n24\ttertiary\t172\n29\tunknown\t3593\n37\tsecondary\t99404\n28\ttertiary\t37583\n43\ttertiary\t80147\n38\tsecondary\t95157\n46\ttertiary\t28075\n32\tprimary\t2897\n80\tprimary\t8031\n67\tunknown\t1392\n48\tsecondary\t60707\n75\tsecondary\t37617\n51\tsecondary\t36140\n78\tprimary\t229\n42\tunknown\t9794\n81\tsecondary\t1\n38\ttertiary\t157119\n39\tunknown\t1169\n66\tsecondary\t14962\n61\tunknown\t4629\n83\tprimary\t1522\n41\ttertiary\t81432\n67\ttertiary\t701\n49\tunknown\t3109\n54\tunknown\t14110\n25\tprimary\t-810\n37\tprimary\t42493\n64\tsecondary\t1574\n30\tprimary\t5562\n48\tunknown\t11852\n63\ttertiary\t133\n41\tprimary\t22592\n37\tunknown\t9610\n47\tprimary\t11363\n39\tsecondary\t66947\n34\tunknown\t4415\n23\tunknown\t817\n20\tsecondary\t1984\n59\tprimary\t25054\n56\tsecondary\t68493\n74\tsecondary\t5935\n59\ttertiary\t32141\n46\tsecondary\t64886\n23\tprimary\t18416\n70\tsecondary\t11445\n43\tprimary\t33859\n57\ttertiary\t39487\n51\tprimary\t29286\n80\tsecondary\t17070\n36\tprimary\t10443\n61\tsecondary\t17735\n19\tprimary\t103\n52\tunknown\t4370\n61\tprimary\t2533\n46\tprimary\t16323\n24\tprimary\t111\n39\ttertiary\t50319\n79\tunknown\t2628\n63\tsecondary\t9030\n45\tsecondary\t48096\n62\tsecondary\t1748\n35\tunknown\t871\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.30.167.54:4040/jobs/job?id=4","http://172.30.167.54:4040/jobs/job?id=5","http://172.30.167.54:4040/jobs/job?id=6","http://172.30.167.54:4040/jobs/job?id=7","http://172.30.167.54:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2020-05-16T19:01:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589655667711_878992140","id":"20200516-190107_1694169510","dateCreated":"2020-05-16T19:01:07+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1915"}],"name":"Demo hare krishna","id":"2FAE69PYA","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}